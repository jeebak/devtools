#!/usr/bin/env bash

[[ $# -eq 0 ]] && echo "usage: git drush-dl-add-commit modulename [module2...]" && exit 1

for i in "$@"; do
  output="$(drush dl "$i" 2>&1 | head -1 | sed 's/ downloaded.*$//')"
  module=$(git status -s | grep '?? ' | grep '/'"$i"'/$' | sed 's/?? //')
  git add "$module"
  git commit -m "Add $output"
done
